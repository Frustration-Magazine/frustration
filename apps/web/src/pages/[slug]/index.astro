---
import BaseLayout from "@web/layout/BaseLayout/BaseLayout.astro";
import ArticleLayout from "@web/layout/ArticleLayout/ArticleLayout.astro";
import {
  type ArticleRaw,
  fetchArticle,
  formatTitleFromRawArticleData,
  formatAuthorFromRawArticleData,
  formatDateFromRawArticleData,
  formatCategoriesFromRawArticleData,
  formatImageFromRawArticleData,
  formatContentFromRawArticleData,
} from "@/data-access/wordpress";

// ðŸ§° Config
// export const prerender = true;

// Dynamic for on demand post
const { slug } = Astro.params;
const article: ArticleRaw = (await fetchArticle({ slug }, [
  "title",
  "slug",
  "author",
  "date",
  "categories",
  "image",
  "content",
])) as ArticleRaw;

// Static for first posts
// export const getStaticPaths = async () => {
//   const ARTICLES_TO_DISPLAY = 9;
//   const articles: ArticleRaw[] = (await fetchArticle(
//     { first: ARTICLES_TO_DISPLAY },
//     ["title", "slug", "author", "date", "categories", "image", "content"],
//   )) as ArticleRaw[];
//   const paths = articles.map((article: ArticleRaw) => ({
//     params: { slug: article.slug },
//     props: { article },
//   }));
//   return paths;
// };
---

<BaseLayout title={formatTitleFromRawArticleData(article)}>
  <ArticleLayout
    title={formatTitleFromRawArticleData(article)}
    author={formatAuthorFromRawArticleData(article)}
    date={formatDateFromRawArticleData(article, { explicit: false })}
    categories={formatCategoriesFromRawArticleData(article)}
    image={formatImageFromRawArticleData(article)}>
    <Fragment
      slot="article-content"
      set:html={formatContentFromRawArticleData(article)}
    />
  </ArticleLayout>
</BaseLayout>
