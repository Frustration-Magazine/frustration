---
import { Image } from "astro:assets";

// 🧱 Components
import { Progress } from "@/ui/components/progress";

// 🖼️ Assets
import bannerEndYear from "./assets/banner_end_year.png";

// 📦 Data
import { fetchNumberOfActiveCustomersLastMonth } from "@/data-access/database";

const numberOfActiveSubscribers = await fetchNumberOfActiveCustomersLastMonth();
const percentActiveSubscribers = +(
  (numberOfActiveSubscribers * 100) /
  1500
).toFixed(0);
---

<a
  href="campagne-abonnements/"
  id="banner"
  class="relative z-10 flex items-center justify-center bg-gradient-to-r from-palePurple to-paleYellow w-full gap-4">
  <Image
    src={bannerEndYear}
    width="500"
    alt="Une bannière pour la campagne de dons"
  />
  <div class="absolute bottom-5">
    <p
      class="text-center mb-2 text-yellow text-4xl text-shadow-lg [text-shadow:0_2px_0_rgb(0_0_0_/_90%)]">
      {percentActiveSubscribers === 0 ? 83 : percentActiveSubscribers}%
    </p>
    <Progress
      value={percentActiveSubscribers === 0 ? 83 : percentActiveSubscribers}
      className="w-[300px] h-7 shadow-lg border-2 border-yellow"
    />
  </div>
</a>
